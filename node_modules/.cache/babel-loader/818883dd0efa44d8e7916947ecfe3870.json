{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.useCssAndCx = exports.createCssAndCx = void 0;\n\nconst classnames_1 = require(\"./tools/classnames\");\n\nconst serialize_1 = require(\"@emotion/serialize\");\n\nconst utils_1 = require(\"@emotion/utils\");\n\nconst useGuaranteedMemo_1 = require(\"./tools/useGuaranteedMemo\");\n\nconst cache_1 = require(\"./cache\");\n\nconst types_1 = require(\"./types\");\n\nexports.createCssAndCx = (() => {\n  function merge(registered, css, className) {\n    const registeredStyles = [];\n    const rawClassName = (0, utils_1.getRegisteredStyles)(registered, registeredStyles, className);\n\n    if (registeredStyles.length < 2) {\n      return className;\n    }\n\n    return rawClassName + css(registeredStyles);\n  }\n\n  function createCssAndCx(params) {\n    const {\n      cache\n    } = params;\n\n    const css = function () {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      const serialized = (0, serialize_1.serializeStyles)(args, cache.registered);\n      (0, utils_1.insertStyles)(cache, serialized, false);\n      const className = `${cache.key}-${serialized.name}`;\n\n      scope: {\n        const arg = args[0];\n\n        if (!(0, types_1.matchCSSObject)(arg)) {\n          break scope;\n        }\n\n        increaseSpecificityToTakePrecedenceOverMediaQuerries.saveClassNameCSSObjectMapping(cache, className, arg);\n      }\n\n      return className;\n    };\n\n    const cx = function () {\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      const className = (0, classnames_1.classnames)(args);\n      const feat27FixedClassnames = increaseSpecificityToTakePrecedenceOverMediaQuerries.fixClassName(cache, className, css);\n      return merge(cache.registered, css, feat27FixedClassnames); //return merge(cache.registered, css, className);\n    };\n\n    return {\n      css,\n      cx\n    };\n  }\n\n  return {\n    createCssAndCx\n  };\n})().createCssAndCx;\n/** Will pickup the contextual cache if any */\n\n\nfunction useCssAndCx() {\n  const cache = (0, cache_1.useTssEmotionCache)();\n  const {\n    css,\n    cx\n  } = (0, useGuaranteedMemo_1.useGuaranteedMemo)(() => (0, exports.createCssAndCx)({\n    cache\n  }), [cache]);\n  return {\n    css,\n    cx\n  };\n}\n\nexports.useCssAndCx = useCssAndCx; // https://github.com/garronej/tss-react/issues/27\n\nconst increaseSpecificityToTakePrecedenceOverMediaQuerries = (() => {\n  const cssObjectMapByCache = new WeakMap();\n  return {\n    \"saveClassNameCSSObjectMapping\": (cache, className, cssObject) => {\n      let cssObjectMap = cssObjectMapByCache.get(cache);\n\n      if (cssObjectMap === undefined) {\n        cssObjectMap = new Map();\n        cssObjectMapByCache.set(cache, cssObjectMap);\n      }\n\n      cssObjectMap.set(className, cssObject);\n    },\n    \"fixClassName\": (() => {\n      function fix(classNameCSSObjects) {\n        let isThereAnyMediaQueriesInPreviousClasses = false;\n        return classNameCSSObjects.map(_ref => {\n          let [className, cssObject] = _ref;\n\n          if (cssObject === undefined) {\n            return className;\n          }\n\n          let out;\n\n          if (!isThereAnyMediaQueriesInPreviousClasses) {\n            out = className;\n\n            for (const key in cssObject) {\n              if (key.startsWith(\"@media\")) {\n                isThereAnyMediaQueriesInPreviousClasses = true;\n                break;\n              }\n            }\n          } else {\n            out = {\n              \"&&\": cssObject\n            };\n          }\n\n          return out;\n        });\n      }\n\n      return (cache, className, css) => {\n        const cssObjectMap = cssObjectMapByCache.get(cache);\n        return (0, classnames_1.classnames)(fix(className.split(\" \").map(className => [className, cssObjectMap === null || cssObjectMap === void 0 ? void 0 : cssObjectMap.get(className)])).map(classNameOrCSSObject => typeof classNameOrCSSObject === \"string\" ? classNameOrCSSObject : css(classNameOrCSSObject)));\n      };\n    })()\n  };\n})();","map":null,"metadata":{},"sourceType":"script"}